# –ó–∞–¥–∞–Ω–∏–µ ‚Ññ1
# üìå –°–æ–∑–¥–∞—Ç—å –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Å—Ç—É–¥–µ–Ω—Ç–∞—Ö —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç–∞.
# üìå –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –¥–æ–ª–∂–Ω–∞ —Å–æ–¥–µ—Ä–∂–∞—Ç—å –¥–≤–µ —Ç–∞–±–ª–∏—Ü—ã: "–°—Ç—É–¥–µ–Ω—Ç—ã" –∏ "–§–∞–∫—É–ª—å—Ç–µ—Ç—ã".
# üìå –í —Ç–∞–±–ª–∏—Ü–µ "–°—Ç—É–¥–µ–Ω—Ç—ã" –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ –ø–æ–ª—è: id, –∏–º—è, —Ñ–∞–º–∏–ª–∏—è,
# –≤–æ–∑—Ä–∞—Å—Ç, –ø–æ–ª, –≥—Ä—É–ø–ø–∞ –∏ id —Ñ–∞–∫—É–ª—å—Ç–µ—Ç–∞.
# üìå –í —Ç–∞–±–ª–∏—Ü–µ "–§–∞–∫—É–ª—å—Ç–µ—Ç—ã" –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ –ø–æ–ª—è: id –∏ –Ω–∞–∑–≤–∞–Ω–∏–µ
# —Ñ–∞–∫—É–ª—å—Ç–µ—Ç–∞.
# üìå –ù–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–æ–∑–¥–∞—Ç—å —Å–≤—è–∑—å –º–µ–∂–¥—É —Ç–∞–±–ª–∏—Ü–∞–º–∏ "–°—Ç—É–¥–µ–Ω—Ç—ã" –∏ "–§–∞–∫—É–ª—å—Ç–µ—Ç—ã".
# üìå –ù–∞–ø–∏—Å–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é-–æ–±—Ä–∞–±–æ—Ç—á–∏–∫, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç –≤—ã–≤–æ–¥–∏—Ç—å —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö
# —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ —Å —É–∫–∞–∑–∞–Ω–∏–µ–º –∏—Ö —Ñ–∞–∫—É–ª—å—Ç–µ—Ç–∞.

from flask import Flask, render_template
from models import db, Faculty, Student

app = Flask(__name__)
app.config['SQLALCHEMY_DATABASE_URI'] = 'sqlite:///university.db'
db.init_app(app)

# —á—Ç–æ–±—ã –∑–∞–ø—É—Å—Ç–∏—Ç—å –≤ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–µ –¥–∞—Ç—å –∫–æ–º–∞–Ω–¥—É: flask init-db
# –≤ –∫–∞—Ç–∞–ª–æ–≥–µ –ø—Ä–æ–µ–∫—Ç–∞ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Ñ–∞–π–ª wsgi.py
# –∑–∞–ø—É—Å–∫ –≤ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–µ –∏–∑ –ø—É—Ç–∏ –ø—Ä–æ–µ–∫—Ç–∞
# –ø–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è, —Ñ–∞–π–ª –ë–î –ø–æ—è–≤–∏—Ç—Å—è –≤ –ø—Ä–æ–µ–∫—Ç–µ –≤ –ø–æ–¥–∫–∞—Ç–∞–ª–æ–≥–µ instance
# —Ä–∞–±–æ—Ç–∞—Ç—å —Å —Ñ–∞–π–ª–æ–º SQLite –º–æ–∂–Ω–æ —Å –ø–æ–º–æ—â—å—é DBeaver, SQLite Studio
@app.cli.command("init-db")
def init_db():
    db.create_all()
    print('init-db OK')


# –Ω–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –ë–î —Ç–µ—Å—Ç–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
# –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –Ω–∞–±—Ä–∞—Ç—å –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ –∫–æ–º–∞–Ω–¥—É: flask fill-db
@app.cli.command("fill-db")
def fill_tables():
    count = 5
    # –î–æ–±–∞–≤–ª—è–µ–º —Ñ–∞–∫—É–ª—å—Ç–µ—Ç—ã
    for number in range(1, count + 1):
        faculty = Faculty(title=f'faculty_{number}')
        db.session.add(faculty)
        db.session.commit()

        # –î–æ–±–∞–≤–ª—è–µ–º —Å—Ç—É–¥–µ–Ω—Ç–æ–≤
        for student_number in range(1, count+1):
            new_student = Student(
                name=f'name_{student_number}',
                surname=f'surname_{student_number}',
                age=22+student_number,
                gender='male',
                group_number=f'{student_number}_{12}',
                faculty_id=faculty.id
            )
            db.session.add(new_student)
            db.session.commit()

    print('fill-db OK')


@app.route('/')
def all_users():
    students = Student.query.all()
    context = {'students': students}
    return render_template('students.html', **context)

# –∑–∞–ø—É—Å–∫–∞—Ç—å –Ω–∞–¥–æ —Ñ–∞–π–ª wsgi.py